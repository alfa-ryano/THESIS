\chapter{Introduction}
\label{ch:introduction}
This Chapter briefly presents the background of this work as well as the research questions that will be 
addressed in this project. Several research objectives are then defined to answer the research questions. 
Lastly, research outputs and scoping are also presented. 

\section{Background}
\label{sec:background}
Most of the models in the context of Model-Driven Engineering are persisted in state-based formats. 
In such approaches, model files contain snapshots of the models' contents, and activities like version control 
and change detection are left to external systems such as file-based version-control systems and model differencing 
facilities. Activities such as change-detection (identifying parts that have changed in a model compared 
to a previous version) and model comparison (finding differences between models) are computationally consuming
for state-based models \cite{Kolovos:2009:DMM:1564596.1564641}. Thus, a new approach is needed to make the 
computation more efficient.

As an alternative to state-based persistence, this work proposes that a model can also be persisted in a change-based format, 
which persists the full sequence of \emph{changes} made to the model instead. 
The concept of change-based persistence is not new and has been used in persisting changes to software, 
object-oriented databases, and hierarchical documents 
\cite{DBLP:journals/entcs/RobbesL07,DBLP:conf/sde/LippeO92,DBLP:conf/caise/IgnatN05}. 
The change-based approach can improve detecting differences more precisely at the semantic 
level -- that is by providing finer-granularity information (e.g. types of changes, the order of the changes, 
elements that were changed, previous values, etc.) -- and therefore provide support to resolve them \cite{mens2002state}. 
The ordered nature of change-based persistence means that changes made to a model can be identified sequentially without 
having to explore and compare all elements of the model and its previous version. Based on these arguments, 
this work explores the advantages and shortcomings of change-based persistence as an alternative approach to 
state-based persistence for models conforming to 3-layer metamodelling architectures such as EMF and MOF. 
Persisting models in a change-based format can bring a number of envisioned benefits over state-based persistence, 
such as the ability to detect changes much faster and more precisely, which can then have positive 
knock-on effects on supporting (1) developers compare and merge models in collaborative modelling environments, 
and (2) incremental model management (e.g., incremental query \cite{DBLP:conf/ecmdafa/RathHV12} and 
model-to-text transformation \cite{DBLP:conf/ecmdafa/OgunyomiRK15}). 

Nevertheless, change-based persistence also comes with downsides, such as ever-growing model files 
\cite{DBLP:journals/entcs/RobbesL07,DBLP:conf/edoc/KoegelHLHD10} and increased model loading time \cite{mens2002state}
which increase storage and computation costs. A model that is frequently modified will increase considerably in file size 
since every change is added to the file. The increased file size (proportional to the number of persisted changes) will, 
in turn, increase the loading time of the model since all changes have to be replayed to reconstruct the model's 
eventual state. These downsides have to be mitigated to enable the practical adoption of change-based persistence. 
One approach to reducing the file size of change-based models is by removing changes that do not affect the eventual 
state of the model. For the increased loading time, it can be mitigated by ignoring -- i.e. not replaying -- changes 
that are cancelled out by later changes or employing change-based and state-based persistence side-by-side so that the
benefits of state-based persistence on loading time can be obtained. Other downsides are change-based persistence requires 
integration with existing tools -- since it is still a non-standard approach -- for its adoption \cite{koegel2010emfstore}, 
and still has limited support for standard, text-based version controls for collaborative development \cite{koegel2010emfstore}. 
These downsides can be addressed by developing a change-based persistence plugin for a specific development environment 
(e.g. Eclipse) and persisting changes in text-based format to support text-based version controls (e.g. Git, SVN).

\section{Research Questions}
\label{sec:research_questions}
The hypothesis of this work is that \textbf{``Change-based model persistence reduces the execution time of model differencing and conflict detection of large models compared to their execution time in state-based model persistence, with acceptable trade-offs on loading and persisting time, memory footprint, and storage space consumption''}. The execution time is the time required to complete the processes (e.g. change-detection, model comparison, model merging, or persisting changes). Model differencing is identifying the differences between two  versions of a model, which elements of features of the model that have different states. Model conflict detection is identifying changes applied to two versions of a model that cause an element or feature of the model has different states in both versions. This condition requires user decision to choose one of the possible states as the end state when both versions are merged.  This work refers ``large models'' to models with more than 1M elements, consistently with \cite{daniel2016neoemf,DBLP:conf/models/Espinazo-PaganCM11}. Model load time is the amount of time required to load a model from its persistence into memory. Persisting changes is saving changes made to a model into a persistent representation (e.g. a file). Memory footprint is the size of the memory occupied  at the time a process finished. Disk space consumption is the amount of storage consumed by the persistence. The term ``acceptable'' means that (1) the solutions proposed in this work deliver improvement on faster loading and saving time with less memory footprint compared to existing solutions as the baselines, or (2) the performance could be slightly worse but in rare condition or not statistically significant, or (3) the cost to accommodate the trade-off is affordable in the current context, such as the cost for extending memory and storage space.

To assess the validity of the hypothesis, this work aims to answer the following research questions: 
\begin{enumerate} 
\item \textbf{How to persist models in a change-based format? How does it perform compared to state-based persistence on loading and saving models? (RQ1)} 

The concept of change-based persistence has to be translated into an implementation in a modelling framework context so that it can be applied for model persistence, and therefore its impact on model loading and saving, model differencing, and model conflict detection can be assessed.

\item \textbf{How to identify differences between two versions of a change-based model? To what extent does change-based model differencing perform, in terms of speed and memory footprint, compared to state-based model differencing? (RQ2)} 

The purpose of using change-based persistence in this work is to speed up model differencing. Due to the nature of change-based persistence, the mechanism to perform change-based model differencing will differ substantially from the current state-based model differencing. It is expected that model differencing in change-based persistence perform faster than model differencing in state-based persistence.        

\item \textbf{How to detect conflicts between two versions of a change-based model? To what extent does change-based model conflict detection perform, in terms of speed and memory, compared to state-based model conflict detection? (RQ3)} 

The knock-on effect of change-based persistence on model conflict detection will also be investigated. It is expected that comparison of change-based models will be significantly faster than the comparison of state-based models.

%\item \textbf{How to merge different change-based models that come from the same ancestor? How does the merging perform compared to model merging in state-based persistence?}
%
%Another knock-on effect of faster change-detection of change-based persistence is faster model merging. Similar to the change-based model comparison, the mechanism to merge change-based models will differ substantially from merging state-based models. It is expected that the change-based model merging will be much faster than state-based model merging.   

\end{enumerate}

\section{Research Objectives}
\label{sec:research_objectives}
This research aims to meet the following research objectives to answer the research questions.
\begin{enumerate}
\item Develop an implementation of change-based persistence so it can be applied to persist models in change-based format, and evaluate the correctness of change-based models that it produces and its performance on saving changes against state-based persistence. 
\item Develop a solution to perform change-based model differencing, and compare its execution time and memory footprint against state-based model differencing.
\item Develop a solution to perform change-based model conflict detection, and compare its execution time and memory footprint against state-based model conflict detection.
\end{enumerate}

\section{Research Outputs}
\label{sec:research_outputs}
By the end of this research, these following outputs will have been produced:
\begin{enumerate}
\item Prototypes for change-based persistence. 
\item Solutions -- including their implementation and evaluation -- for loading time reduction and saving, model differencing, and model conflict detection of change-based persistence.
\item Publications and a thesis documenting the outcomes of this research.
\end{enumerate}

\section{Research Scope}
\label{sec:research_scope}
The scope of this research will be restricted to models conforming to 3-level metamodelling architectures. The Eclipse Modelling Framework will be used, as a representative example of such architectures, for the implementation of all algorithms and prototypes.

\section{Thesis Structure}
\label{sec:Thesis Structure}
This section provides the overview of each chapter presented in this thesis.

\subsection{Chapter 1: Introduction}
\label{sec:chapter_1_introduction_plan}
This chapter is intended to present the motivation and purpose of this research. It comprises the background of the research as well as the research hypothesis, research questions, research objectives, research outputs, research scope, thesis structure, and published papers. 

\subsection{Chapter 2: Literature Review}
\label{sec:chapter_2_literature_review_plan}
This chapter is dedicated to summarise work related to change-based persistence and comparison, critically assesses the advantages and disadvantages of current approaches, and seek the opportunities to contribute novel knowledge to the field. The chapter comprises brief discussion on methods to identify changes in models, the benefits of change-based solutions to model management, the advantages and drawbacks state and change-based persistence in the context of software engineering, the state of art of model persistence, the state of art of model comparison, state-based model differencing, state-based conflict detection, change-based conflict detection, and the research method applied in this work.

\subsection{Chapter 3: Change-based Model Persistence}
\label{sec:chapter_3_Change-based_model_ersistence_plan}
This chapter presents the concept of change-based model persistence and its core implementation. It comprises the concept of change-based model persistence, and the design of the core implementation. These contents have been published in a workshop \cite{DBLP:conf/models/YohannisKP17}.


\subsection{Chapter 4: Optimised Loading of Change-based Models}
\label{sec:chapter_4_optimised_loading_change_based_model_persistence}

Change-based persistence comes with a downside of ever-growing file sizes \cite{DBLP:journals/entcs/RobbesL07,DBLP:conf/edoc/KoegelHLHD10} which causes increased loading time \cite{mens2002state}. Reducing the loading time is essential to facilitate the practical adoption of change-based persistence. One way to reduce the increased loading time is by ignoring -- not replaying -- changes that are cancelled out by subsequent changes. 

To evaluate the efficiency of the proposed approach, the optimised loading is compared to a naive loading of a change-based representation and loading the same model from a state-based representation. They are compared on time required to load models and the memory footprint after loading models. Evaluation is also performed on time required for persisting changes between change-based and state-based persistence to show the benefit of change-based persistence on saving changes. 

This chapter is intended to present the optimisation approach along with its implementation and evaluation. The contents of this chapter is largely based on a published conference paper \cite{yohannis2018towards}. 

\subsection{Chapter 5: Hybrid Model Persistence}
\label{sec:chapter_5_hybrid_model_persistence}
While optimised loading is faster than the naive loading, the benefits are moderate and that the optimised loading is still slower than loading from a state-based representation \cite{DBLP:conf/models/YohannisRPK18}. This finding has motivated the design and development of a hybrid persistence approach, that is augmenting a change-based representation with a state-based representation. 

The hybrid model persistence approach is evaluated by comparing it to state-based persistence (e.g. XMI, NeoEMF \cite{daniel2016neoemf}) on time, memory footprint, and storage space required for loading models and persisting changes. The evaluation is also performed on time required for detecting changes between hybrid and state-based persistence to show the benefit of change-based persistence over state-based model comparison. 

This chapter is dedicated to present the hybrid model persistence approach together with its implementation and evaluation. The contents of this chapter is be largely based on a workshop paper \cite{DBLP:conf/models/YohannisRPK18}.

\subsection{Chapter 6: Efficient Model Differencing of Change-based Models}
\label{sec:chapter_6_model_differencing}
This chapter presents a change-based model differencing with its implementation and evaluation. Change-based persistence is expected to speed-up model differencing because the information required to identify changes is already contained in the models' persistence. 

The proposed model differencing is evaluated by comparing it to state-based model differencing on the time and memory footprint required to find all differences between two versions of a model. The contents of this chapter is be largely based on a workshop paper \cite{yohannis2018efficient}.

\subsection{Chapter 7: Efficient Conflict Detection of Change-based Models}
\label{sec:chapter_7_conflict_detection}
This chapter is planned to present change-based model conflict detection. After identifying the differences between two versions of a change-based model, this work also aims to detect conflict between two versions of a model. Model conflict detection is a crucial step that precedes model merging.

Similar to change-based model comparison in Section \ref{sec:chapter_6_model_differencing}, the proposed conflict detection is also evaluated by comparing it to the conflict detection of existing change and state-based persistence on the affected time and memory footprint.

\subsection{Chapter 8: Conclusions and Future Work}
\label{sec:chapter_8_conclusions_and_future_work}
This chapter summarises the work that has been carried and the evaluation results obtained in order to answer the research requestions and hypothesis proposed in Section \ref{sec:research_questions}. However, the conclusions also come with limitations and threat to validity which are also presented in the chapter. The chapter also presents the future work that can be done to address the limitations of this work, to extend the features of the proposed change-based model persistence, or for other research topics.

\section{Publications}
\label{sec:publications}
This research has published several papers in workshops and conferences. They are as follow:
\begin{enumerate}
  \item A. Yohannis, D. S. Kolovos, and F. Polack, ``Turning models inside out,'' in Proceedings of MODELS 2017 Satellite Events co-located with ACM/IEEE 20th International Conference on Model Driven Engineering Languages and Systems (MODELS 2017), Austin, TX, USA, September, 17, 2017., 2017, pp. 430–434. [Online]. Available: \url{http://ceur-ws.org/Vol-2019/flexmde_8.pdf}.
  \item  A. Yohannis, H. H. Rodriguez, F. Polack, and D. S. Kolovos, ``Towards efficient loading of change-based models,'' in Modelling Foundations and Applications - 14th European Conference, ECMFA 2018, Held as Part of STAF 2018, Toulouse,  France, June 26-28, 2018, Proceedings, 2018, pp. 235–250. [Online]. Available: \url{https://doi.org/10.1007/978-3-319-92997-2_15}.
  \item  A. Yohannis, H. H. Rodriguez, F. Polack, and D. S. Kolovos, ``Towards hybrid model persistence,'' in Proceedings of MODELS 2018 Workshops co-located with ACM/IEEE 21st International Conference on Model Driven Engineering Languages and Systems (MODELS 2018), Copenhagen, 
  Denmark, October, 14, 2018., 2018, pp. 594–603. [Online]. Available:  \url{http://ceur-ws.org/Vol-2245/me_paper_3.pdf}.
  \item  A. Yohannis, H. H. Rodriguez, F. Polack, and D. Kolovos,``Towards efficient comparison of change-based models,'' B. Combemale and A. Shaukat, Eds., vol. 18, no. 2, Jul. 2019, pp. 7:1–21, the 15th European Conference on Modelling Foundations and Applications. [Online]. Available: 
  \url{http://www.jot.fm/contents/issue_2019_02/article7.html}.
\end{enumerate}
